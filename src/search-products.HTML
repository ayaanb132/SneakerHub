<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search for Products</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .bg-primary { background-color: #111111; }
        .text-primary { color: #222222; }
        .text-subtext { color: #666666; }
    </style>
</head>
<body class="flex items-center justify-center h-screen" style="background-color: #F5F5F5;">

    <div class="bg-white p-6 rounded shadow-md w-full max-w-md relative">
        <h1 class="text-2xl font-bold mb-4 text-center" style="color: #222222;">Search for Products</h1>

        <div class="relative">
            <div class="flex items-center border rounded px-3 py-2" style="border-color: #E5E5E5;">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" style="color: #666666;">
                    <circle cx="11" cy="11" r="8"></circle>
                    <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                </svg>
                <input type="text" id="searchInput" placeholder="Enter product name" class="w-full outline-none" style="color: #222222;" autocomplete="off">
            </div>

            <ul id="resultsList" class="hidden absolute z-10 w-full bg-white border border-t-0 rounded-b shadow-lg max-h-60 overflow-y-auto" style="border-color: #E5E5E5;">
                <!-- List items injected by JS -->
            </ul>
        </div>

        <p class="text-center mt-4 text-sm" style="color: #666666;" id="statusText">Start typing to search...</p>
        <!-- Helper message for testing -->
        <p class="text-center mt-2 text-xs text-red-400">Note: Redirects only work when files are saved locally.</p>
    </div>

    <script>
        // Configuration: Ensure the 'url' filename matches exactly what you saved the other file as.
        const products = [
            { name: "Air Force", url: "product.html?id=black-air-force-1s" }, 
            { name: "Jordan 1 Purple", url: "product.html?id=jordan-1s-court-purple" }, 
            { name: "Jordan 1", url: "product.html?id=jordan-1s-court-purple" }, 
            { name: "Nike Panda", url: "product.html?id=nike-dunks-panda" }, 
            { name: "Red Thunders", url: "product.html?id=jordan-4s-red-thunders" }
        ];

        const searchInput = document.getElementById('searchInput');
        const resultsList = document.getElementById('resultsList');
        const statusText = document.getElementById('statusText');

        function getFilteredProducts(query) {
            if (!query) return [];
            return products.filter(product => 
                product.name.toLowerCase().includes(query.toLowerCase())
            );
        }

        searchInput.addEventListener('input', function() {
            const query = this.value;
            resultsList.innerHTML = ''; 

            if (query.length === 0) {
                resultsList.classList.add('hidden');
                statusText.textContent = "Start typing to search...";
                return;
            }

            const filteredProducts = getFilteredProducts(query);

            if (filteredProducts.length > 0) {
                filteredProducts.forEach(product => {
                    const li = document.createElement('li');
                    li.textContent = product.name;
                    li.className = "px-4 py-2 cursor-pointer hover:bg-gray-100 text-primary transition-colors duration-150 block border-b border-gray-100 last:border-0";
                    
                    // Enhanced Click Handler
                    li.addEventListener('click', function(e) {
                        e.stopPropagation(); // Prevents conflict with document click listener
                        console.log("Redirecting to:", product.url); // Check your browser console if it fails
                        window.location.href = product.url; 
                    });
                    
                    resultsList.appendChild(li);
                });
                resultsList.classList.remove('hidden');
                statusText.textContent = `Found ${filteredProducts.length} product(s)`;
            } else {
                resultsList.classList.add('hidden');
                statusText.textContent = "No products found.";
            }
        });

        // Enter Key Handler
        searchInput.addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                const query = this.value;
                const filteredProducts = getFilteredProducts(query);
                if (filteredProducts.length > 0) {
                    window.location.href = filteredProducts[0].url;
                }
            }
        });

        // Close dropdown when clicking outside
        document.addEventListener('click', function(e) {
            // If the click was NOT on the search input AND NOT on the results list
            if (!searchInput.contains(e.target) && !resultsList.contains(e.target)) {
                resultsList.classList.add('hidden');
            }
        });
    </script>
</body>
</html>