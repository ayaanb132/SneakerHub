<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>SneakerHub – Product Details</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .bg-primary { background-color: #111111; }
        .bg-accent { background-color: #00C853; }
        .bg-cta { background-color: #FF3D00; }
        .hover-bg-cta:hover { background-color: #e63600; }
        .text-primary { color: #222222; }
        .text-subtext { color: #666666; }
        .text-accent { color: #00C853; }

        /* Size button styles */
        .size-btn {
            padding: 0.45rem 1rem;
            border-radius: 999px;
            border: 1px solid #ddd;
            font-size: 0.875rem;
            background-color: #ffffff;
            color: #222222;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            transition: all 0.2s ease;
        }

        .size-btn:hover {
            border-color: #00C853;
        }

        .size-btn-selected {
            background-color: #00C853;
            color: #ffffff;
            border-color: #00C853;
        }

        .size-btn-check {
            font-size: 0.85rem;
            margin-left: 2px;
        }
    </style>
</head>
<body class="bg-gray-100">

    <nav class="bg-primary text-white p-4">
        <div class="max-w-5xl mx-auto flex justify-between items-center">
            <a href="index.HTML" class="font-bold text-xl">SneakerHub</a>
            <a href="index.HTML" class="text-sm underline">Back to Home</a>
        </div>
    </nav>

    <main class="max-w-5xl mx-auto p-6">
        <div id="product-container" class="bg-white rounded-2xl shadow-xl overflow-hidden flex flex-col md:flex-row">

            <div class="md:w-1/2 bg-white flex items-center justify-center p-8">
                <div class="overflow-hidden rounded-2xl">
                    <!-- Note: Added a placeholder onerror to prevent broken image icons if local images are missing -->
                    <img
                        id="product-image"
                        src=""
                        alt=""
                        onerror="this.src='https://placehold.co/400x400?text=No+Image'"
                        class="max-w-full max-h-[550px] object-contain transform transition-transform duration-300 ease-out hover:scale-110"
                    >
                </div>
            </div>

            <div class="md:w-1/2 p-8 flex flex-col gap-4">
                <div>
                    <h1 id="product-name" class="text-3xl font-bold text-primary mb-2"></h1>
                    <p id="product-price" class="text-2xl font-semibold text-accent mb-2"></p>
                    <p id="product-description" class="text-subtext"></p>
                </div>

                <span id="product-status" class="inline-block text-xs px-3 py-1 rounded bg-accent text-white w-fit"></span>

                <div class="mt-4">
                    <h2 class="font-semibold mb-2 text-primary">Select Size</h2>
                    <div id="size-buttons" class="flex flex-wrap gap-2"></div>
                    <p id="size-error" class="text-sm text-red-600 mt-1 hidden">Please select a size.</p>
                </div>

                <button
                    id="add-to-cart-btn"
                    class="mt-6 w-full bg-cta text-white font-semibold py-3 rounded-lg hover-bg-cta text-lg"
                >
                    Add to Cart
                </button>
            </div>
        </div>
    </main>

    <script>
        function getProductIdFromUrl() {
            const params = new URLSearchParams(window.location.search);
            return params.get('id');
        }

        // Note: Image paths are relative. Ensure you have a 'shoes' folder with these images.
        const products = {
            'nike-dunks-panda': {
                name: 'Nike Dunks: Panda',
                price: '$119.00',
                description: 'Fashionable black and white dunks.',
                image: 'shoes/nike-pandas.jpg',
                status: 'Available',
                sizes: ['4','5','6','7','8','9','10','11','12']
            },
            'jordan-4s-red-thunders': {
                name: 'Jordan 4s: Red Thunders',
                price: '$450.99',
                description: 'Comfortable everyday sneakers.',
                image: 'shoes/red-thunders.jpg',
                status: 'New Arrival',
                sizes: ['4','5','6','7','8','9','10','11','12']
            },
            'jordan-1s-court-purple': {
                name: 'Jordan 1s: Court Purple',
                price: '$79.99',
                description: 'Stylish high-top shoes with bold purple accents.',
                image: 'shoes/jordan-1s-purple.jpg',
                status: 'Available',
                sizes: ['4','5','6','7','8','9','10','11','12']
            },
            'black-air-force-1s': {
                name: 'Black Air Force 1s',
                price: '$99.99',
                description: 'Classic all-black Air Force 1s for everyday wear.',
                image: 'shoes/air-force-1s.jpg',
                status: 'Available',
                sizes: ['4','5','6','7','8','9','10','11','12']
            }
        };

        let selectedSize = null;
        let currentProductId = null;

        function renderProduct(productId) {
            const product = products[productId];
            // If product not found, handle gracefully (optional)
            if (!product) {
                document.getElementById('product-name').textContent = "Product Not Found";
                return;
            }

            currentProductId = productId;

            document.getElementById('product-name').textContent = product.name;
            document.getElementById('product-price').textContent = product.price;
            document.getElementById('product-description').textContent = product.description;
            document.getElementById('product-image').src = product.image;
            document.getElementById('product-image').alt = product.name;
            document.getElementById('product-status').textContent = product.status;

            const sizeContainer = document.getElementById('size-buttons');
            sizeContainer.innerHTML = '';
            selectedSize = null;
            document.getElementById('size-error').classList.add('hidden');

            product.sizes.forEach(size => {
                const btn = document.createElement('button');
                btn.className = 'size-btn';
                btn.dataset.size = size;

                btn.innerHTML = `
                    <span>${size}</span>
                    <span class="size-btn-check"></span>
                `;

                btn.addEventListener('click', () => {
                    selectedSize = size;
                    document.getElementById('size-error').classList.add('hidden');

                    // Remove selected style from all
                    Array.from(sizeContainer.children).forEach(child => {
                        child.classList.remove('size-btn-selected');
                        child.querySelector('.size-btn-check').textContent = '';
                    });

                    // Add to selected button
                    btn.classList.add('size-btn-selected');
                    btn.querySelector('.size-btn-check').textContent = '✓';
                });

                sizeContainer.appendChild(btn);
            });
        }

        function addToCart() {
            if (!selectedSize) {
                document.getElementById('size-error').classList.remove('hidden');
                return;
            }

            const product = products[currentProductId];
            const cartItem = {
                id: currentProductId,
                name: product.name,
                price: product.price,
                size: selectedSize,
                quantity: 1
            };

            const existing = JSON.parse(localStorage.getItem('cart') || '[]');
            existing.push(cartItem);
            localStorage.setItem('cart', JSON.stringify(existing));

            alert(`Added ${product.name} (Size ${selectedSize}) to your cart.`);
        }

        document.addEventListener('DOMContentLoaded', () => {
            // Commented out Auth check for easier testing
            /*
            const authToken = localStorage.getItem('authToken');
            if (!authToken) {
                if (confirm('Please login to view product details. Go to login page?')) {
                    window.location.href = 'src/user-registration.HTML';
                }
                return;
            }
            */
            renderProduct(getProductIdFromUrl());
            document.getElementById('add-to-cart-btn').addEventListener('click', addToCart);
        });
    </script>
</body>
</html>